/**
 * LOFTER APP分享接口
 * @version  1.0
 * @author   chenyao(hzchenyao@corp.netease.com)
 * @param  {Object} _options 可选配置参数，已处理参数列表如下
 *                           id	         [Number]	         - 6002
 *                           url	     [string]	         - 页面当前URL
 *                           content	 [object]	         - 分享的内容对象
 *                                       weiboImg     [string]    - 微博分享图片
 *                                       weiboDesc    [string]    - 微博分享的描述
 *                                       fImg         [string]    - 微信分享图片
 *                                       fTitle       [string]    - 微信分享标题
 *                                       fDesc        [string]    - 微信分享描述
 *                                       domains      [Array]     - []
 */
let ua = navigator.userAgent.toLowerCase();
const lofterShareConfig = (shareCnt) => {
    try {
        if(ua.indexOf('android') >= 0){
            let string = JSON.stringify(shareCnt)
            window.ViewControllerPush.saveShareContent(string)
        }else if(ua.indexOf('iphone') >= 0){
            connectWebViewJavascriptBridge(bridge => bridge.callHandler('saveShareContent', shareCnt));
        }
    } catch(e) {}
};

const lofetrShare = () => {
    if (ua.indexOf('android') >= 0) {
        window.ViewControllerPush.showMenu();
    } else if (ua.indexOf('iphone') >= 0) {
        connectWebViewJavascriptBridge(bridge => bridge.callHandler('showMenu'));
    }
};

/**
 * IOS APP jsBridge
 * @return {Void}
 */
const connectWebViewJavascriptBridge = callback => {
    if (window.WebViewJavascriptBridge) {
        callback(WebViewJavascriptBridge)
    } else {
        document.addEventListener('WebViewJavascriptBridgeReady', () => callback(WebViewJavascriptBridge), false)
    }
};

export  {
    lofterShareConfig,
    lofetrShare
}
